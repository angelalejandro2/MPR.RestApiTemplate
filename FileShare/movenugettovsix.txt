param(
    [Parameter(Mandatory = $false)]
    [string]$NugetSourcePath = "./output/nuget",

    [Parameter(Mandatory = $false)]
    [string]$VsixProjectPath = "./MPR.RestApiTemplate.Vsix/NuGet"
)

function Move-NugetPackage {
    if (!(Test-Path $NugetSourcePath)) {
        Write-Warning "‚ùå No se encontr√≥ la carpeta de paquetes NuGet en '$NugetSourcePath'"
        return
    }

    $nupkg = Get-ChildItem -Path $NugetSourcePath -Filter *.nupkg | Select-Object -Last 1

    if ($null -eq $nupkg) {
        Write-Warning "‚ö†Ô∏è No se encontr√≥ ning√∫n archivo .nupkg en '$NugetSourcePath'"
        return
    }

    if (!(Test-Path $VsixProjectPath)) {
        Write-Host "üìÅ Creando carpeta de destino: $VsixProjectPath"
        New-Item -ItemType Directory -Path $VsixProjectPath -Force | Out-Null
    }

    Copy-Item -Path $nupkg.FullName -Destination $VsixProjectPath -Force

    Write-Host "‚úÖ Paquete '$($nupkg.Name)' copiado a '$VsixProjectPath'"
}

Move-NugetPackage